var _dng = null;

document.addEventListener("mouseup", () => {
	if (!_dng)
		return;

	var horizontal = !inRange(_dng.target.offsetLeft, -_dng.target.clientWidth + 1, _dng.target.parentElement.clientWidth - 1);
	var vertical = !inRange(_dng.target.offsetTop, -_dng.target.clientHeight + 1, _dng.target.parentElement.clientHeight - 1);
	if (horizontal || vertical)
		_dng.target.remove();
	_dng.target.removeClassName("active");
	document.body.removeClassName("grabbing");
	_dng = null;
});

document.addEventListener("mousemove", e => {
	if (!_dng)
		return;

	var offset = _dng.target.parentElement.absoluteOffset;
	var posX = e.pageX - offset.left - _dng.offsetX;
	var posY = e.pageY - offset.top - _dng.offsetY;
	_dng.target.style.left = posX + 'px';
	_dng.target.style.top = posY + 'px';
});

function stikerSelector() {
	var div = document.createElement("div").addClassName("stiker_w");
	div.onmousedown = function(e) {
		var parent = this.parentElement;
		this.remove();
		parent.appendChild(this);
		_dng = {
			target: this,
			offsetX: e.offsetX,
			offsetY: e.offsetY,
		};
		this.addClassName("active");
		document.body.addClassName("grabbing");
	}
	place.appendChild(div);

	var stiker = document.createElement("img").addClassName("stiker").setParams({src: this.src});
	stiker.ondragstart = function() {return false;}
	div.appendChild(stiker);
}

// onmousedown: null
// onmouseenter: null
// onmouseleave: null
// onmousemove: null
// onmouseout: null
// onmouseover: null
// onmouseup: null
// onmousewheel: null